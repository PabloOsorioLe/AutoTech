<div class="container-fluid mt-custom px-5">
  <h1 class="text-center mb-5 fw-bold text-primary">Ventas del Día</h1>

  <!-- Total general destacado -->
  <div class="total-general mb-4 p-3 rounded bg-primary bg-opacity-10 shadow-sm text-center fs-4 fw-semibold text-primary">
    Total Vendido: {{ totalVentas | currency:'CLP' }}
  </div>

  <div *ngIf="ventasDelDia.length > 0" class="ventas-list border border-secondary rounded p-3 bg-white shadow-sm">
    <!-- Lista compacta de ventas -->
   <div *ngFor="let venta of ventasDelDia"
     class="venta-item mb-2 p-3 rounded shadow-sm bg-light"
     [class.venta-seleccionada]="venta.id === ventaSeleccionadaId"
     (click)="abrirModal(venta)"
     role="button"
     tabindex="0"
     (keydown.enter)="abrirModal(venta)"
     [attr.aria-label]="'Ver detalles venta ' + venta.id">

      <div class="d-flex justify-content-between align-items-center">
        <div>
          <strong>Total:</strong> {{ venta.total | currency:'CLP' }}
        </div>
        <div>
          <strong>Hora:</strong> {{ venta.fecha | date:'shortTime' }}
        </div>
        <div>
          <strong>Pago:</strong> 
          <span *ngIf="venta.pagos.length > 0">
            {{ venta.pagos[0].metodo | titlecase }}
          </span>
          <span *ngIf="venta.pagos.length === 0">No registrado</span>
        </div>
      </div>
    </div>
  </div>

  <div *ngIf="ventasDelDia.length === 0" class="text-center mt-5 fs-5">
    <p>No se encontraron ventas para el día de hoy.</p>
  </div>

  <!-- Modal Detalle Venta -->
  <div class="modal fade" id="detalleVentaModal" tabindex="-1" aria-labelledby="detalleVentaModalLabel" aria-hidden="true">
    <div class="modal-dialog modal-lg modal-dialog-scrollable">
      <div class="modal-content">
        <div class="modal-header bg-primary text-white">
          <h5 class="modal-title" id="detalleVentaModalLabel">Detalle Venta #{{ ventaSeleccionada?.id }}</h5>
          <button type="button" class="btn-close btn-close-white" data-bs-dismiss="modal" aria-label="Cerrar"></button>
        </div>
        <div class="modal-body" *ngIf="ventaSeleccionada">
         <p><strong>Fecha:</strong> {{ ventaSeleccionada.fecha | date:'dd/MM/yyyy' }}</p>
          <p><strong>Total:</strong> {{ ventaSeleccionada.total | currency:'CLP' }}</p>

          <h6>Medios de Pago:</h6>
          <ul>
            <li *ngFor="let pago of ventaSeleccionada.pagos">
              {{ pago.metodo | titlecase }}: {{ pago.monto | currency:'CLP' }}
            </li>
          </ul>

          <h6>Productos Comprados:</h6>
          <table class="table table-bordered table-striped">
            <thead class="table-secondary">
              <tr>
                <th>Producto</th>
                <th>Precio Unitario</th>
                <th>Cantidad</th>
                <th>SubTotal</th>
              </tr>
            </thead>
            <tbody>
              <tr *ngFor="let detalle of ventaSeleccionada.detalles">
                <td>{{ detalle.nombre }}</td>
                <td>{{ detalle.precioUnitario | currency:'CLP' }}</td>
                <td>{{ detalle.cantidad }}</td>
                <td>{{ detalle.subTotal | currency:'CLP' }}</td>
              </tr>
            </tbody>
          </table>
        </div>
        <div class="modal-footer">
          <button type="button" class="btn btn-secondary" data-bs-dismiss="modal">Cerrar</button>
        </div>
      </div>
    </div>
  </div>
</div>
